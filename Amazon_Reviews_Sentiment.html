{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "dc087c52",
   "metadata": {},
   "source": [
    "Amazon Product Reviews Sentiment Analysis\n",
    "\n",
    "This script performs sentiment analysis on Amazon consumer reviews.\n",
    "It loads and cleans review text data, removes stopwords and non-alphabetic\n",
    "tokens, and then uses spaCy with SpacyTextBlob to calculate sentiment\n",
    "polarity scores. Each review is classified as Positive, Negative, or\n",
    "Neutral based on its polarity value.\n",
    "\n",
    "The final output provides sentiment distribution results to help assess\n",
    "overall customer satisfaction."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02072583",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import relevant libraries\n",
    "import pandas as pd\n",
    "import spacy\n",
    "from spacytextblob.spacytextblob import SpacyTextBlob\n",
    "\n",
    "# Load spaCy model \n",
    "nlp = spacy.load(\"en_core_web_md\")\n",
    "\n",
    "# Add sentiment tool\n",
    "nlp.add_pipe(\"spacytextblob\")  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d862691",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load dataset\n",
    "dataframe = pd.read_csv(\"Datafiniti_Amazon_Consumer_Reviews_of_Amazon_Products_May19.csv\")\n",
    "\n",
    "# Get review text column\n",
    "reviews_data = dataframe[\"reviews.text\"]\n",
    "\n",
    "# Drop empty reviews\n",
    "clean_data = dataframe.dropna(subset=[\"reviews.text\"])\n",
    "\n",
    "# Clean text\n",
    "def preprocess_text(text):\n",
    "    \"\"\"Lowercase, trim, remove stopwords & non-letters\"\"\"\n",
    "    doc = nlp(text.lower().strip())\n",
    "    tokens = [t.text for t in doc if not t.is_stop and t.is_alpha]\n",
    "    return \" \".join(tokens)\n",
    "\n",
    "clean_data[\"clean_reviews\"] = clean_data[\"reviews.text\"].apply(preprocess_text)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2f48bc2a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Sentiment function\n",
    "def analyze_sentiment(review):\n",
    "    \"\"\"Return polarity (-1 to 1) and label\"\"\"\n",
    "    doc = nlp(review)\n",
    "    polarity = doc._.blob.polarity\n",
    "    if polarity > 0:\n",
    "        sentiment = \"Positive\"\n",
    "    elif polarity < 0:\n",
    "        sentiment = \"Negative\"\n",
    "    else:\n",
    "        sentiment = \"Neutral\"\n",
    "    return polarity, sentiment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4858588a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "--- Sample Sentiment Analysis ---\n",
      "\n",
      "Review: order item bad quality missing backup spring pcs aluminum battery work... | Polarity: -0.45 | Sentiment: Negative\n",
      "Review: bulk expensive way products like... | Polarity: -0.50 | Sentiment: Negative\n",
      "Review: duracell price happy... | Polarity: 0.80 | Sentiment: Positive\n",
      "Review: work brand batteries better price... | Polarity: 0.50 | Sentiment: Positive\n",
      "Review: batteries long lasting price great... | Polarity: 0.25 | Sentiment: Positive\n"
     ]
    }
   ],
   "source": [
    "# Test on sample reviews\n",
    "print(\"\\n--- Sample Sentiment Analysis ---\\n\")\n",
    "sample_reviews = clean_data[\"clean_reviews\"].head(5).tolist()\n",
    "\n",
    "for review in sample_reviews:\n",
    "    score, sent = analyze_sentiment(review)\n",
    "    print(f\"Review: {review[:80]}... | Polarity: {score:.2f} | Sentiment: {sent}\")\n",
    "\n",
    "# Run on all reviews\n",
    "clean_data[\"polarity\"], clean_data[\"sentiment\"] = zip(\n",
    "    *clean_data[\"clean_reviews\"].map(analyze_sentiment)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "689bd101",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "--- Sentiment results ---\n",
      "\n",
      "Analyzed 28332 reviews.\n",
      "Sentiment counts: {'Positive': 23207, 'Neutral': 3048, 'Negative': 2077}\n",
      "\n",
      "Most reviews are 'Positive', showing general customer satisfaction.\n"
     ]
    }
   ],
   "source": [
    "#  Sentiment esults\n",
    "sentiment_counts = clean_data[\"sentiment\"].value_counts().to_dict()\n",
    "print(\"\\n--- Sentiment results ---\\n\")\n",
    "print(f\"Analyzed {len(clean_data)} reviews.\")\n",
    "print(f\"Sentiment counts: {sentiment_counts}\\n\")\n",
    "print(\"Most reviews are 'Positive', showing general customer satisfaction.\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
